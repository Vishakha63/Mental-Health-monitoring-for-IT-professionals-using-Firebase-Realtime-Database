<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Vishakha</title>
    <style>
        label {
            display:inline-block;
            font-size: 16px;
            font-family:Arial,Arial, Helvetica, sans-serif;
            width:110px;
        }
        input,
        select {
            width: 180px0;
            height: 30px;
            font-size: 16px;
            font-family:Arial, Helvetica, sans-serif
        }

        button{
            height:30px;
            width:140px;
            font-size: 16px;
            font-family:Arial, Helvetica, sans-serif
        }
    </style>
</head>
<body style="background-color:powderblue;">
     <label>User_ID</label>
     <input type = "text" , id ="UserIDInp">
     <br><br>
    
     <label>Age</label>
     <input type = "number" , id ="AgeInp">
     <br><br>

     <label>Gender</label>
     <select id = "GenderInp">
        <option value ="Male">Male</option>
        <option value ="Female">Female</option>
        <option value ="Other">Other</option>
     </select>
     <br><br>

     <label>Technology Usage Hours</label>
     <input type = "number" , id ="TechUsageInp", step ="any">
     <br><br>

     <label>Social Media Usage Hours</label>
     <input type = "number" , id ="SocialMediaUsageInp", step ="any">
     <br><br>

     <label>Gaming Hours</label>
     <input type = "number" , id ="GamingHoursUsageInp", step ="any">
     <br><br>

     <label>Screen Time Hours</label>
     <input type = "number" , id ="ScreenTimeInp", step ="any">
     <br><br>

     <label>Mental Health Status</label>
     <select id = "MentalStatusInp">
        <option value ="Poor">Poor</option>
        <option value ="Fair">Fair</option>
        <option value ="Good">Good</option>
        <option value ="Excellent">Excellent</option>
    </select>
    <br><br>

     <label>Stress Level</label>
     <select id = "StressLevelInp">
        <option value ="Low">Low</option>
        <option value ="Medium">Medium</option>
        <option value ="High">High</option>
    </select>
    <br><br>

     <label>Sleep Hours</label>
     <input type = "number" , id ="SleepHoursInp", step ="any">
     <br><br>

     <label>Physical Activity Hours</label>
     <input type = "number" , id ="PhysicalActivityHoursInp", step ="any">
     <br><br>

        
     <label>Support Systems Access</label>
     <select id = "SupportSystemAccessInp">
        <option value ="Yes">Yes</option>
        <option value ="No">No</option>
    </select>
    <br><br>

    <label>Work Environment Impact</label>
    <select id = "WorkEnvImpactInp">
       <option value ="Negative">Negative</option>
       <option value ="Positive">Positive</option>
       <option value ="Neutral">Neutral</option>
    </select>
    <br><br>

   <label>Online Support Usage</label>
   <select id = "OnlineSupportUsageInp">
      <option value ="Yes">Yes</option>
      <option value ="No">No</option>
    </select>
    <br><br>

    

    <button id = "ButtonForAdding">Add Details</button>
    <button id = "ButtonForRetrieving">Retrieve Details</button>
    <button id = "ButtonForUpdating">Update Details</button>
    <button id = "ButtonForDeleting">Delete Details</button>

    <script type="module">
        // Importing the functions from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-analytics.js";
        
      
        // Our web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyCdnJOAYR118pNTBJETavSE1tT39hMYecI",
          authDomain: "final244project.firebaseapp.com",
          databaseURL: "https://final244project-default-rtdb.firebaseio.com",
          projectId: "final244project",
          storageBucket: "final244project.appspot.com",
          messagingSenderId: "79226875048",
          appId: "1:79226875048:web:0d613c7d65f12e02f7a69d",
          measurementId: "G-RS9G5WQJEN"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        //importing the functions needed
        import {getDatabase, ref, child, get, set, update, remove} from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js"

        const db = getDatabase();

        // Retieving the input values into the variables
        let UserIDInp = document.getElementById('UserIDInp');
        let AgeInp = document.getElementById('AgeInp');
        let GenderInp = document.getElementById('GenderInp');
        let TechUsageInp = document.getElementById('TechUsageInp');
        let SocialMediaUsageInp = document.getElementById('SocialMediaUsageInp');
        let GamingHoursUsageInp = document.getElementById('GamingHoursUsageInp');
        let ScreenTimeInp = document.getElementById('ScreenTimeInp');
        let MentalStatusInp = document.getElementById('MentalStatusInp');
        let StressLevelInp = document.getElementById('StressLevelInp');
        let SleepHoursInp = document.getElementById('SleepHoursInp');
        let PhysicalActivityHoursInp = document.getElementById('PhysicalActivityHoursInp');
        let SupportSystemAccessInp = document.getElementById('SupportSystemAccessInp');
        let WorkEnvImpactInp = document.getElementById('WorkEnvImpactInp');
        let OnlineSupportUsageInp = document.getElementById('OnlineSupportUsageInp');
        let ButtonForAdding = document.getElementById('ButtonForAdding');
        let ButtonForRetrieving = document.getElementById('ButtonForRetrieving');
        let ButtonForUpdating = document.getElementById('ButtonForUpdating');
        let ButtonForDeleting = document.getElementById('ButtonForDeleting');

        // function for handling unique records. Firebase lacks capability of identifying unique records
        function MainInterfaceFunction(e){

            //Retrieving the ID of the button that triggered the Interface functionality
            let IdButton = e.target.id;

            if (IdButton == 'ButtonForRetrieving'){
                Retrieving_Data();
                return;
            }

            const dbRef = ref(db);
            // snapshot is an object that contains data from the specified path
            get(child(dbRef,'EmployeeSet/' + UserIDInp.value)).then((snapshot)=>{
                // if the record exists and the button is Add Button, then alerting that the user with the data already exists.
                if(snapshot.exists()){
                    if(IdButton == 'ButtonForAdding')
                        alert("The record for the employee that has been entered already exists");

                    else if (IdButton == 'ButtonForUpdating')
                        Updating_Data();

                    else if (IdButton == 'ButtonForDeleting')
                        Deleting_Data();
         
                }
                //if the record does not exists, the new record can be added. If the update or delete buttons are clicked  if the record is not present,
                // an alert message- The record does not exist, will be displayed 
                else{
                    
                    if(IdButton == 'ButtonForAdding')
                        Adding_Data();

                    else if (IdButton == 'ButtonForUpdating')
                        alert("The record does not exists. The the required data cannot be updated.Make sure the data exists before updating it!")

                    else if (IdButton == 'ButtonForDeleting')
                        alert("The record does not exists. The the required data cannot be deleted.Make sure the data exists before deleting it!")
         
                }
                
                
            })
            .catch((error)=>{
                alert("Unsuccessful");
                console.log(error);
        })

        }
        // function for adding data to the database
        function Adding_Data(){
            set(ref(db,'EmployeeSet/' + UserIDInp.value),{
                USER_ID:UserIDInp.value,
                Age: parseInt(AgeInp.value),
                Gender:GenderInp.value,
                Technology_Usage_Hours:parseFloat(TechUsageInp.value),
                Social_Media_Usage_Hours:parseFloat(SocialMediaUsageInp.value),
                Gaming_Hours:parseFloat(GamingHoursUsageInp.value),
                Screen_Time_Hours:parseFloat(ScreenTimeInp.value),
                Mental_Health_Status:MentalStatusInp.value,
                Stress_Level:StressLevelInp.value,
                Sleep_Hours:parseFloat(SleepHoursInp.value),
                Physical_Activity_Hours:parseFloat(PhysicalActivityHoursInp.value),
                Support_Systems_Access:SupportSystemAccessInp.value,
                Work_Environment_Impact:WorkEnvImpactInp.value,
                Online_Support_Usage:OnlineSupportUsageInp.value,
            })
            .then(()=>{
                alert("Data added successfully");
                console.log("User ID is",UserIDInp.value);
            })
            .catch((error)=>{
                alert("Unsuccessful");
                console.log(error);
            })
        }

        // function for retrieving data from the database
        function Retrieving_Data(){
            const dbRef = ref(db);
            get(child(dbRef,'EmployeeSet/' + UserIDInp.value)).then((snapshot)=>{
                if(snapshot.exists()){
                    UserIDInp.value = snapshot.val().USER_ID;
                    AgeInp.value = snapshot.val().Age;
                    GenderInp.value = snapshot.val().Gender;
                    TechUsageInp.value = snapshot.val().Technology_Usage_Hours;
                    SocialMediaUsageInp.value = snapshot.val().Social_Media_Usage_Hours;
                    GamingHoursUsageInp.value = snapshot.val().Gaming_Hours;
                    ScreenTimeInp.value = snapshot.val().Screen_Time_Hours;
                    MentalStatusInp.value = snapshot.val().Mental_Health_Status;
                    StressLevelInp.value = snapshot.val().Stress_Level;
                    SleepHoursInp.value = snapshot.val().Sleep_Hours;
                    PhysicalActivityHoursInp.value = snapshot.val().Physical_Activity_Hours;
                    SupportSystemAccessInp.value = snapshot.val().Support_Systems_Access;
                    WorkEnvImpactInp.value = snapshot.val().Work_Environment_Impact;
                    OnlineSupportUsageInp.value = snapshot.val().Online_Support_Usage;
                }
                else{
                    alert("Employee does not exist");
                }
                
            })
            .catch((error)=>{
                alert("Unsuccessful");
                console.log(error);
        })
    }

    //Function for updating the records
    function Updating_Data(){
            update(ref(db,'EmployeeSet/' + UserIDInp.value),{
                USER_ID:UserIDInp.value,
                Age:parseInt(AgeInp.value),
                Gender:GenderInp.value,
                Technology_Usage_Hours:parseFloat(TechUsageInp.value),
                Social_Media_Usage_Hours:parseFloat(SocialMediaUsageInp.value),
                Gaming_Hours:parseFloat(GamingHoursUsageInp.value),
                Screen_Time_Hours:parseFloat(ScreenTimeInp.value),
                Mental_Health_Status:MentalStatusInp.value,
                Stress_Level:StressLevelInp.value,
                Sleep_Hours:parseFloat(SleepHoursInp.value),
                Physical_Activity_Hours:parseFloat(PhysicalActivityHoursInp.value),
                Support_Systems_Access:SupportSystemAccessInp.value,
                Work_Environment_Impact:WorkEnvImpactInp.value,
                Online_Support_Usage:OnlineSupportUsageInp.value,
            })
            .then(()=>{
                alert("Data updated successfully");
            })
            .catch((error)=>{
                alert("Unsuccessful");
                console.log(error);
            })
        }

        //Function for deleting the records
        function Deleting_Data(){
            remove(ref(db,'EmployeeSet/' + UserIDInp.value),
            )
            .then(()=>{
                alert("Data deleted successfully");
            })
            .catch((error)=>{
                alert("Unsuccessful");
                console.log(error);
            })
        }

    
        //Assigning the MainInterfaceFunction function to all the buttons
        ButtonForAdding.addEventListener('click', MainInterfaceFunction);
        ButtonForRetrieving.addEventListener('click',MainInterfaceFunction);
        ButtonForUpdating.addEventListener('click', MainInterfaceFunction);
        ButtonForDeleting.addEventListener('click', MainInterfaceFunction);
        

      </script>


</body>
</html>